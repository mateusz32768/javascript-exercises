function AJAX(t){return this instanceof AJAX?(this._xhr=new XMLHttpRequest,this._config=this._extendOptions(t),this._assignEvents(),void this._beforeSend()):new AJAX(t)}AJAX.prototype._extendOptions=function(t){var e=JSON.parse(JSON.stringify(this._defaultConfig));for(var i in e)i in t||(t[i]=e[i]);return t},AJAX.prototype._assignEvents=function(){this._xhr.addEventListener("readystatechange",this._handleResponse.bind(this),!1),this._xhr.addEventListener("abort",this._handleError.bind(this),!1),this._xhr.addEventListener("error",this._handleError.bind(this),!1),this._xhr.addEventListener("timeout",this._handleError.bind(this),!1)},AJAX.prototype._assignUserHeaders=function(){if(Object.keys(this._config.headers).length)for(var t in this._config.headers)this._xhr.setRequestHeader(t,this._config.headers[t])},AJAX.prototype._open=function(){this._xhr.open(this._config.type,this._config.url,this._config.options.async,this._config.options.username,this._config.options.password),this._xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),this._xhr.timeout=this._config.options.timeout},AJAX.prototype._beforeSend=function(){var t=Object.keys(this._config.data).length>0,e=null;"POST"===this._config.type.toUpperCase()&&t?e=this._serializeFormData(this._config.data):"GET"===this._config.type.toUpperCase()&&t&&(this._config.url+="?"+this._serializeData(this._config.data)),this._open(),this._assignUserHeaders(),this._send(e)},AJAX.prototype._send=function(t){this._xhr.send(t)},AJAX.prototype._handleResponse=function(){4===this._xhr.readyState&&this._xhr.status>=200&&this._xhr.status<400?"function"==typeof this._config.success&&this._config.success(this._xhr.response,this._xhr):4===this._xhr.readyState&&this._xhr.status>=400&&this._handleError()},AJAX.prototype._handleError=function(){"function"==typeof this._config.failure&&this._config.failure(this._xhr)},AJAX.prototype._serializeData=function(t){var e="";for(var i in t)e+=i+"="+encodeURIComponent(t[i])+"&";return e.slice(0,e.length-1)},AJAX.prototype._serializeFormData=function(t){var e=new FormData;for(var i in t)e.append(i,t[i]);return e},AJAX.prototype._defaultConfig={type:"GET",url:window.location.href,data:{},options:{async:!0,timeout:0,username:null,password:null},headers:{}};